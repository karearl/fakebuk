<!-- newPostForm.hbs -->
<div class="flex flex-col w-full p-4 bg-gray-800 rounded shadow">
    <div class="flex-1">
        <textarea id="newPostTextarea"
            class="w-full px-3 py-2 text-sm text-white bg-gray-800 border border-gray-600 rounded placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50"
            placeholder="Write a post..."></textarea>
    </div>
</div>
<script>
    const textarea = document.querySelector('#newPostTextarea');
    textarea.addEventListener('keydown', (event) => {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            const newPostContent = event.target.value;
            fetch('/post', {
                method: 'POST',
                headers: {
                    'Content-Type': 'text/plain',
                },
                body: JSON.stringify({
                    content: newPostContent,
                    userId: {{{user_id}}}
                })})
                .then((response) => {
                    if (response.ok) {
                        event.target.value = '';
                        window.location.reload();
                        return response.json();
                    }
                    throw new Error('Failed to send POST request');
                })
                .catch((error) => {
                    console.error('Failed to send POST request:', error);
                });
        }
    });
</script>